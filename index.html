<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HTEAM PROXY (v·ªõi SheetDB)</title>
  <style>
    :root {
      --neon: #28ff28;
      --bg: #000;
      --panel: #051005;
    }
    body {
      background: var(--bg);
      color: var(--neon);
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 24px;
      text-align: center;
    }
    h1 {
      display: inline-block;
      padding: 12px 18px;
      border: 2px solid var(--neon);
      border-radius: 8px;
      margin: 0 auto;
    }
    .controls {
      margin-top: 18px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }
    input, select {
      padding: 8px;
      border-radius: 6px;
      border: 2px solid var(--neon);
      background: #000;
      color: #fff;
      font-size: 16px;
    }
    button {
      padding: 10px 16px;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      font-size: 16px;
    }
    #scanBtn { background: var(--neon); color: #000; }
    #checkBtn { background: #00A3FF; color: #fff; }
    #refreshBtn { background: #fff; color: #000; }
    #deleteBtn { background: #FF4444; color: #fff; }
    #copyBtn { background: #FFD700; color: #000; }
    textarea {
      width: 100%;
      height: 260px;
      margin-top: 18px;
      padding: 12px;
      border-radius: 8px;
      border: 3px solid var(--neon);
      background: #000;
      color: #ffb;
      font-family: monospace;
      font-size: 14px;
    }
    #adminToggle {
      position: fixed;
      right: 14px;
      top: 14px;
      opacity: 0;
      width: 36px;
      height: 36px;
      cursor: pointer;
    }
    .modal-backdrop {
      position: fixed;
      left: 0; top: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);
      display: none;
      align-items: center;
      justify-content: center;
    }
    .modal {
      background: linear-gradient(180deg, #052205, #071207);
      border: 2px solid var(--neon);
      padding: 18px;
      border-radius: 12px;
      min-width: 320px;
      color: #fff;
    }
    .modal h2 { margin-top: 0; }
    .row {
      margin: 8px 0;
      display: flex;
      gap: 8px;
      align-items: center;
    }
    .small { font-size: 13px; color: #cfc; }
    .btn-primary {
      background: var(--neon);
      color: #000;
      padding: 8px 12px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
    }
    .btn-ghost {
      background: transparent;
      color: var(--neon);
      border: 1px solid var(--neon);
      padding: 8px;
      border-radius: 8px;
      cursor: pointer;
    }
    .admin-hidden { display: none; }
    @media (max-width: 600px) {
      .controls { flex-direction: column; align-items: stretch; }
      .controls label { width: 100%; display: block; margin-bottom: 6px; }
      .controls label input,
      .controls label select { width: 100%; margin-top: 4px; }
      .controls button { width: 100%; margin-top: 8px; }
      textarea { height: 200px; }
      h1 { font-size: 20px; }
    }
@keyframes blink {
  50% { opacity: 0.5; }
}
.scanning {
  animation: blink 1s infinite;
}
  </style>
</head>
<body>

<!-- Popup th√¥ng b√°o -->
  <div id="noticePopup" style="
    position: fixed;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    background: #000;
    border: 2px solid #28ff28;
    border-radius: 12px;
    box-shadow: 0 0 20px #28ff28;
    padding: 24px 30px 50px 30px;
    width: 80%;
    max-width: 400px;
    text-align: center;
    color: #fff;
    font-size: 18px;
    z-index: 10000;
  ">
    <div id="noticeText" style="color: #ffb; font-weight: bold;">
      <p>Th√¥ng b√°o üíÅ</p>
      <p>App Scan Proxy Free By HTeam</p>
      <p>Kh√¥ng s·ª≠ d·ª•ng cho b·∫•t k√¨ h√†nh vi ph·∫°m ph√°p n√†o,m·ªçi h√†nh vi vi ph·∫°m ph√°p lu·∫≠t ch√∫ng t√¥i s·∫Ω kh√¥ng ch·ªãu tr√°ch nhi·ªám li√™n ƒë·ªõi.Tool free n√™n proxy l√† d·∫°ng public.M·ªçi v·∫•n ƒë·ªÅ th·∫Øc m·∫Øc vui l√≤ng li√™n h·ªáüëá</p>
       <p>Facebook: viethung2002tienhai</p>
       <p>Zalo: 03.87.67.5932</p>
    </div>
    <button id="closeNotice" style="
      position: absolute;
      bottom: 12px; right: 16px;
      background: #28ff28;
      color: #000;
      border: none;
      border-radius: 8px;
      padding: 6px 10px;
      cursor: pointer;
      font-weight: bold;
    ">X</button>
  </div>

  <h1>HTEAM PROXY</h1>

  <!-- N√∫t ·∫©n admin -->
  <button id="adminToggle" title="Admin">‚öôÔ∏è</button>

  <div class="controls">
    <label>Quantity: <input id="quantity" type="number" value="3" min="1" /></label>
    <label>Classify:
      <select id="classify">
        <option value="any">ANY</option>
        <option value="http">HTTP</option>
        <option value="socks4">SOCKS4</option>
        <option value="socks5">SOCKS5</option>
      </select>
    </label>
    <button id="scanBtn">SCAN</button>
    <button id="checkBtn">CHECK LIVE</button>
    <button id="refreshBtn">REFRESH LIST</button>
    <button id="deleteBtn">DELETE LIST</button>
    <button id="copyBtn">COPY ALL</button>
  </div>

  <textarea id="output" readonly placeholder="Proxy list s·∫Ω hi·ªán ·ªü ƒë√¢y..."></textarea>

  <div id="modalBackdrop" class="modal-backdrop">
    <div class="modal" role="dialog" aria-modal="true">
      <div id="pwScreen">
        <h2>Admin login</h2>
        <div class="row">
          <input id="adminPassInput" type="password" placeholder="Nh·∫≠p m·∫≠t kh·∫©u admin" style="flex:1" />
          <button id="pwSubmit" class="btn-primary">OK</button>
        </div>
        <div class="small">Nh·∫≠p m·∫≠t kh·∫©u ƒë·ªÉ truy c·∫≠p ch·ª©c nƒÉng th√™m proxy.</div>
      </div>

      <div id="adminPanel" class="admin-hidden">
        <h2>Admin ‚Äî Add Proxies</h2>
        <div class="small">Nh·∫≠p proxy m·ªói d√≤ng d·∫°ng: <code>type,ip:port</code> ho·∫∑c ch·ªâ <code>ip:port</code> (m·∫∑c ƒë·ªãnh type s·∫Ω l√† http)</div>
        <div class="row" style="flex-direction:column">
          <textarea id="adminTextarea" placeholder="vd: http,101.2.3.4:80"></textarea>
        </div>
        <div class="row" style="justify-content:flex-end">
          <button id="adminAddBtn" class="btn-primary">Add to Sheet</button>
          <button id="adminCloseBtn" class="btn-ghost">Close</button>
        </div>
        <div id="adminStatus" class="small" style="margin-top:8px"></div>
      </div>
    </div>
  </div>

  <script>
    const SHEETDB_API = "https://sheetdb.io/api/v1/lagrhwnp19f0s";
    const ADMIN_PASS = "hteamhmg";

    let proxies = [];
    let lastPicked = [];

    function showMessage(msg) {
      const out = document.getElementById('output');
      out.value = msg + "\n\n" + out.value;
    }

    // l·∫•y danh s√°ch t·ª´ SheetDB
    async function fetchList() {
      try {
        const res = await fetch(SHEETDB_API);
        const data = await res.json();
        proxies = data.map(row => ({
          type: row.type ? row.type.toLowerCase() : "http",
          addr: row.addr
        }));
        showMessage("D·ªØ li·ªáu proxy s·∫Ω hi·ªán ·ªü ƒë√¢y");
      } catch (err) {
        showMessage("L·ªói t·∫£i danh s√°ch: " + err.message);
      }
    }

    function filterByType(list, cls) {
      if (cls === 'any') return list;
      return list.filter(p => p.type === cls);
    }

    function sample(arr, n) {
      const copy = arr.slice();
      const out = [];
      for (let i = 0; i < n && copy.length > 0; i++) {
        const idx = Math.floor(Math.random() * copy.length);
        out.push(copy.splice(idx, 1)[0]);
      }
      return out;
    }

    document.getElementById('scanBtn').addEventListener('click', () => {
  const qty = parseInt(document.getElementById('quantity').value) || 1;
  const cls = document.getElementById('classify').value;
  const out = document.getElementById('output');

  // Hi·ªán th√¥ng b√°o ƒëang scan (nh·∫•p nh√°y)
  out.value = "üîç ƒêang scan d·ªØ li·ªáu proxy...\n\n";
  out.classList.add('scanning');

  // V√¥ hi·ªáu h√≥a n√∫t SCAN ƒë·ªÉ tr√°nh b·∫•m li√™n t·ª•c
  const btn = document.getElementById('scanBtn');
  btn.disabled = true;

  // Sau 3 gi√¢y hi·ªÉn th·ªã k·∫øt qu·∫£
  setTimeout(() => {
    const filtered = filterByType(proxies, cls);

    // N·∫øu kh√¥ng c√≥ proxy ph√π h·ª£p
    if (filtered.length === 0) {
      out.classList.remove('scanning');
      out.value = "‚ùå Kh√¥ng t√¨m th·∫•y proxy lo·∫°i " + cls;
      btn.disabled = false;
      return;
    }

    // Ch·ªçn ng·∫´u nhi√™n proxy
    lastPicked = sample(filtered, qty);
    const lines = lastPicked.map(p => p.type + "," + p.addr);

    // D·ª´ng hi·ªáu ·ª©ng nh·∫•p nh√°y, hi·ªÉn th·ªã th√¥ng b√°o ho√†n t·∫•t
    out.classList.remove('scanning');
    out.value = "‚úÖ ƒê√£ scan ƒë∆∞·ª£c proxy!\n\n" + lines.join("\n") + "\n\n" + out.value;

    btn.disabled = false;
  }, 3000); // Delay 3 gi√¢y
});

    document.getElementById('checkBtn').addEventListener('click', async () => {
      if (!lastPicked.length) {
        alert("B·∫°n ch∆∞a SCAN proxy n√†o.");
        return;
      }
      const text = lastPicked.map(p => p.addr).join("\n");
      try {
        await navigator.clipboard.writeText(text);
        window.open("https://proxy.mkvn.net/Checkproxy", "_blank");
        alert("ƒê√£ copy proxy v·ª´a scan. Vui l√≤ng d√°n (Ctrl+V) v√†o trang Checkproxy.");
      } catch (e) {
        alert("Kh√¥ng th·ªÉ copy t·ª± ƒë·ªông. Proxy:\n\n" + text);
      }
    });

    document.getElementById('refreshBtn').addEventListener('click', fetchList);

    document.getElementById('deleteBtn').addEventListener('click', () => {
      document.getElementById('output').value = "";
      lastPicked = [];
      showMessage("ƒê√£ xo√° danh s√°ch proxy trong khung.");
    });

    document.getElementById('copyBtn').addEventListener('click', async () => {
      const text = document.getElementById('output').value.trim();
      if (!text) {
        alert("Kh√¥ng c√≥ g√¨ ƒë·ªÉ copy.");
        return;
      }
      try {
        await navigator.clipboard.writeText(text);
        alert("ƒê√£ copy to√†n b·ªô danh s√°ch proxy.");
      } catch (err) {
        alert("Copy th·∫•t b·∫°i: " + err.message);
      }
    });

    // Admin logic
    const adminToggle = document.getElementById('adminToggle');
    const modal = document.getElementById('modalBackdrop');
    const pwScreen = document.getElementById('pwScreen');
    const adminPanel = document.getElementById('adminPanel');
    const adminPassInput = document.getElementById('adminPassInput');
    const pwSubmit = document.getElementById('pwSubmit');
    const adminTextarea = document.getElementById('adminTextarea');
    const adminAddBtn = document.getElementById('adminAddBtn');
    const adminCloseBtn = document.getElementById('adminCloseBtn');
    const adminStatus = document.getElementById('adminStatus');

    adminToggle.addEventListener('click', () => {
      modal.style.display = 'flex';
      pwScreen.style.display = 'block';
      adminPanel.classList.add('admin-hidden');
      adminStatus.textContent = '';
      adminPassInput.value = '';
      adminPassInput.focus();
    });

    adminCloseBtn.addEventListener('click', () => {
      modal.style.display = 'none';
    });

    pwSubmit.addEventListener('click', () => {
      if (adminPassInput.value === ADMIN_PASS) {
        pwScreen.style.display = 'none';
        adminPanel.classList.remove('admin-hidden');
        adminStatus.textContent = "B·∫°n ƒë√£ ƒëƒÉng nh·∫≠p.";
      } else {
        adminStatus.textContent = "M·∫≠t kh·∫©u sai.";
      }
    });

    adminAddBtn.addEventListener('click', async () => {
  const raw = adminTextarea.value.trim();
  if (!raw) {
    adminStatus.textContent = "Vui l√≤ng nh·∫≠p √≠t nh·∫•t 1 proxy.";
    return;
  }
  const lines = raw.split(/\r?\n/).map(l=>l.trim()).filter(Boolean);
  const items = lines.map(l => {
    if (l.includes(',')) {
      const [t,a] = l.split(',').map(s=>s.trim());
      return { type: t.toLowerCase(), addr: a };
    } else {
      return { type: 'http', addr: l };
    }
  });

  adminStatus.textContent = "ƒêang g·ª≠i...";
  try {
    const res = await fetch(SHEETDB_API, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ data: items }),
    });
    const result = await res.json();
    adminStatus.textContent = "ƒê√£ th√™m " + items.length + " proxy v√†o sheet.";
    fetchList();
  } catch (err) {
    adminStatus.textContent = "L·ªói: " + err.message;
  }
});

    // Kh·ªüi ƒë·ªông
    // Khi b·∫•m X, ƒë√≥ng b·∫£ng th√¥ng b√°o v√† kh·ªüi ƒë·ªông ch∆∞∆°ng tr√¨nh
  document.getElementById('closeNotice').addEventListener('click', () => {
    document.getElementById('noticePopup').style.display = 'none';
    // B·∫Øt ƒë·∫ßu ch·∫°y ch∆∞∆°ng tr√¨nh sau khi ng∆∞·ªùi d√πng ƒë√≥ng th√¥ng b√°o
    fetchList();
  });

  // Ban ƒë·∫ßu: ·∫©n to√†n b·ªô c√°c ph·∫ßn kh√°c cho ƒë·∫øn khi ƒë√≥ng th√¥ng b√°o
  window.addEventListener('load', () => {
    document.querySelector('h1').style.opacity = '0.3';
    document.querySelector('.controls').style.pointerEvents = 'none';
    document.querySelector('.controls').style.opacity = '0.3';
    document.getElementById('output').style.opacity = '0.3';
  });

  // Khi ƒë√≥ng th√¥ng b√°o, b·∫≠t l·∫°i giao di·ªán
  document.getElementById('closeNotice').addEventListener('click', () => {
    document.querySelector('h1').style.opacity = '1';
    document.querySelector('.controls').style.pointerEvents = 'auto';
    document.querySelector('.controls').style.opacity = '1';
    document.getElementById('output').style.opacity = '1';
  });
  </script>
<!-- Footer gi·ªõi thi·ªáu -->
  <footer style="
    margin-top: 40px;
    padding-top: 10px;
    border-top: 1px solid var(--neon);
    color: #ccc;
    font-size: 14px;
    text-align: center;
    line-height: 1.6;
  ">
    <div>Version: 2.0</div>
    <div>Admin: HTeam Nguy·ªÖn Vi·ªát H√πng</div>
    <div>Fb: viethung2002tienhai</div>
  </footer>
</body>
</html>
